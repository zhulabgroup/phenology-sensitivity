---
title: "leafing_flowering_lag"
output: html_document
date: "2023-05-18"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# download data
```{r include=FALSE}
source("scripts/download_npn.R")
```

# select data
## datasource: Nature's notebook similar to neon (powerpoint)
## phenophase: 2 & 7 has the most observations (taxa). However 1 & 7 has grass (taxa_1). Both use linear regression

# check distribution of data

# correlation beween flowering and leafing
## linear regression
## robust linear regression
taxa_rlm
## circular-circular statistics
Visual for cc_statistics
1.each genus a pdf
2.combined figure for one species in each genus
```{r}
source("scripts/plot_cc_stat_1speciespergenus.R")
combined_plot
rm(list = ls())
```

# lag and gddlag between flower and leaf
boxplot
histogram
```{r}
source("scripts/plot_histogram_of_lag.R")
```

statistics tibble
delete outliers
what statistics should we use to report the lag (average+std), is the outstanding zero value be a problem?
```{r}
source("scripts/table_lag_statistics.R")
rm(list = ls())
```

```{r}
source("scripts/plot_avail_individual_yr.R")

```



### lag with climate

-------------------
# the whole story
get data
```{r message=FALSE, warning=FALSE}
source("scripts/function_npn_select_model_data.R")

data <- get_modelled_data()
```

# Introduction
flower time and amount is important phenology related to seed production and pollen.

studying them need data

lots of trees are wind pollinated trees which has catkin flowers, and is hard to observe

while leafing observation is easier by satillite images

so we want to using leaf to infer flower, at least inform the potential species that can be infer from leaf to flower

# leaf flower correlation
whether leaf and flower is correlated (select highly related species)
```{r}
source("scripts/function_npn_select_model_data.R")
print(combined_plot)
rm(list = setdiff(ls(), "data"))

```

# leaf flowering calendar day lag (average + std)
select species with small std
```{r}
source("scripts/table_lag_statistics.R")
source("scripts/plot_lag_statistics.R")
print(combinefigure)
rm(list = setdiff(ls(), "data"))
```


# leaf flowering gdd day lag
if we have temperature, the lag can be further precisely informed 

# 



---------
# SI

## data availability: need to be combined in a figure
```{r}
source("scripts/plot_avail_individual_yr.R")

```

## lag histogram: the distribution behind the mean and std we repoted
This is important information, maybe think about making a large figure
```{r message=FALSE, warning=FALSE}
source("scripts/plot_histogram_of_lag.R")

```




